- name: Quick Node Exporter Check
  hosts: all
  become: yes
  vars_files:
   - accessvm.yaml

  tasks:
    - name: Quick HTTP check for Node Exporter
      uri:
        url: "http://{{ ansible_default_ipv4.address }}:9100/metrics"
        method: GET
        status_code: 200
        timeout: 3
      register: quick_check
      ignore_errors: yes

    - name: Display quick status
      debug:
        msg: "{{ ansible_hostname }} ({{ ansible_default_ipv4.address }}): {{ 'RUNNING ✓' if quick_check.status == 200 else 'NOT RUNNING ✗' }}"
